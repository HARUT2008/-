<!DOCTYPE html>
<html>
 <body>
  <canvas id="c" width="800" height="600"></canvas>
   <script>
	const C = document.getElementById('c').getContext('2d');
	const W = C.canvas.width;
	const H = C.canvas.height;
	const epsilon =0.1;
	const scale = 20;
	const x0 = W / 2;
	const y0 = H / 2;

	async function morphSinToCos() {
	  for (let i = 0; i <= 100; i++) {
	    const t = (i / 100) * (Math.PI / 2);
	    drawFrame(t);
	    await new Promise(r => setTimeout(r, 0.1));
	  }
	}

	function drawFrame(phaseShift) {
	  const I = C.createImageData(W, H);
	  let i = 0;

	  for (let y = 0; y < H; y++) {
	    for (let x = 0; x < W; x++) {
	      const X = (x - x0) / scale;
	      const Y = (y0 - y) / scale;

  	      const p = getPixel(X, Y, phaseShift);

	      I.data[i++] = p.r * 255;
	      I.data[i++] = p.g * 255;
	      I.data[i++] = p.b * 255;
	      I.data[i++] = p.a * 255;
	    }
	  }
	
	  C.putImageData(I, 0, 0);
	}

	function getPixel(x, y, phase) {
	  let p = background();

	  const sine = wave(x, y, Math.sin, phase, 1, 1);
	  const cosine = wave(x, y, Math.cos, 0, 1, 1);
	  const axesX = axis(y);
	  const axesY = axis(x);


	  if (sine.a > 0) p = sine;
	  if (cosine.a > 0) p = cosine;
	  if (axesX.a > 0) p = axesX;
	  if (axesY.a > 0) p = axesY;

	  return p;
	}

	function background() {
	  return { r: 0, g: 0, b: 0, a: 0 };
	}

	function wave(x, y, func, phase, amplitude, frequency) {
	  const yExpected = amplitude * func(frequency * x + phase);
	  const onCurve = Math.abs(y - yExpected) < epsilon;
	  return { r: func === Math.sin ? 1 : 0, g: 0, b: func === Math.cos ? 1 : 0, a: onCurve ? 1 : 0 };
	}

	function axis(v) {
	  const onLine = Math.abs(v) < epsilon;
	  return { r: 0, g: 0, b: 0, a: onLine ? 1 : 0 };
	}

	morphSinToCos();
  </script>
 </body>
</html>

